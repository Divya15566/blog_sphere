{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{Form,Button,Alert,Spinner}from'react-bootstrap';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EditBlogScreen=()=>{const{id}=useParams();const navigate=useNavigate();const[title,setTitle]=useState('');const[content,setContent]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[submitting,setSubmitting]=useState(false);useEffect(()=>{const fetchBlog=async()=>{try{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}const config={headers:{'x-auth-token':token}};const{data}=await axios.get(`/api/blogs/${id}`,config);// Check if current user is the author\nconst userData=await axios.get('/api/users/me',config);if(data.author._id!==userData.data._id){navigate('/');return;}setTitle(data.title);setContent(data.content);setLoading(false);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.msg)||'Error fetching blog');setLoading(false);}};fetchBlog();},[id,navigate]);const submitHandler=async e=>{e.preventDefault();setSubmitting(true);setError(null);try{const token=localStorage.getItem('token');const config={headers:{'x-auth-token':token}};await axios.put(`/api/blogs/${id}`,{title,content},config);navigate('/myblogs');}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.msg)||'Error updating blog');}finally{setSubmitting(false);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"})});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\",children:error})});return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-6\",children:\"Edit Blog\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",className:\"block text-gray-700 font-medium mb-2\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",value:title,onChange:e=>setTitle(e.target.value),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",className:\"block text-gray-700 font-medium mb-2\",children:\"Content\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"content\",rows:10,value:content,onChange:e=>setContent(e.target.value),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting,className:\"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200 disabled:opacity-50\",children:submitting?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Updating...\"]}):'Update Blog'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>navigate('/myblogs'),className:\"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg transition duration-200\",children:\"Cancel\"})]})]})]});};export default EditBlogScreen;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","Form","Button","Alert","Spinner","axios","jsx","_jsx","jsxs","_jsxs","EditBlogScreen","id","navigate","title","setTitle","content","setContent","loading","setLoading","error","setError","submitting","setSubmitting","fetchBlog","token","localStorage","getItem","config","headers","data","get","userData","author","_id","err","_err$response","_err$response$data","response","msg","submitHandler","e","preventDefault","put","_err$response2","_err$response2$data","className","children","onSubmit","htmlFor","type","value","onChange","target","required","rows","disabled","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","d","onClick"],"sources":["C:/Users/divya/blog-app/client/src/screens/EditBlogScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Form, Button, Alert, Spinner } from 'react-bootstrap';\r\nimport axios from 'axios';\r\n\r\nconst EditBlogScreen = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [title, setTitle] = useState('');\r\n  const [content, setContent] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchBlog = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          navigate('/login');\r\n          return;\r\n        }\r\n\r\n        const config = {\r\n          headers: {\r\n            'x-auth-token': token\r\n          }\r\n        };\r\n\r\n        const { data } = await axios.get(`/api/blogs/${id}`, config);\r\n        \r\n        // Check if current user is the author\r\n        const userData = await axios.get('/api/users/me', config);\r\n        if (data.author._id !== userData.data._id) {\r\n          navigate('/');\r\n          return;\r\n        }\r\n\r\n        setTitle(data.title);\r\n        setContent(data.content);\r\n        setLoading(false);\r\n      } catch (err) {\r\n        setError(err.response?.data?.msg || 'Error fetching blog');\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchBlog();\r\n  }, [id, navigate]);\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n    setError(null);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const config = {\r\n        headers: {\r\n          'x-auth-token': token\r\n        }\r\n      };\r\n\r\n      await axios.put(\r\n        `/api/blogs/${id}`,\r\n        { title, content },\r\n        config\r\n      );\r\n      navigate('/myblogs');\r\n    } catch (err) {\r\n      setError(err.response?.data?.msg || 'Error updating blog');\r\n    }finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) return (\r\n    <div className=\"flex justify-center items-center h-screen\">\r\n      <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\r\n    </div>\r\n  );\r\n\r\n  if (error) return (\r\n    <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\r\n        {error}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">Edit Blog</h1>\r\n      \r\n      {error && (\r\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6\">\r\n          {error}\r\n        </div>\r\n      )}\r\n      \r\n      <form onSubmit={submitHandler} className=\"bg-white rounded-lg shadow-md p-6\">\r\n        <div className=\"mb-6\">\r\n          <label htmlFor=\"title\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Title\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"title\"\r\n            value={title}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\r\n            required\r\n          />\r\n        </div>\r\n        \r\n        <div className=\"mb-6\">\r\n          <label htmlFor=\"content\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Content\r\n          </label>\r\n          <textarea\r\n            id=\"content\"\r\n            rows={10}\r\n            value={content}\r\n            onChange={(e) => setContent(e.target.value)}\r\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\r\n            required\r\n          />\r\n        </div>\r\n        \r\n        <div className=\"flex space-x-4\">\r\n          <button\r\n            type=\"submit\"\r\n            disabled={submitting}\r\n            className=\"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200 disabled:opacity-50\"\r\n          >\r\n            {submitting ? (\r\n              <span className=\"flex items-center\">\r\n                <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n                Updating...\r\n              </span>\r\n            ) : 'Update Blog'}\r\n          </button>\r\n          \r\n          <button\r\n            type=\"button\"\r\n            onClick={() => navigate('/myblogs')}\r\n            className=\"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg transition duration-200\"\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditBlogScreen;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}